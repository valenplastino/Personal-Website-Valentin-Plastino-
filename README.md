I've adapted codes from ChatGPT
